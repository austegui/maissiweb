---
phase: 02-authentication
plan: 03
type: execute
wave: 3
depends_on: ["02-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "The Vercel deployment builds and loads without errors"
    - "Visiting the Vercel URL without being logged in redirects to /login"
    - "Logging in with valid credentials redirects to the inbox"
    - "The inbox page loads and functions after login"
    - "Logging out redirects back to /login"
    - "Session persists across browser refresh (user stays logged in)"
  artifacts: []
  key_links: []
---

<objective>
Push all Phase 2 code to GitHub (triggering Vercel auto-deploy) and verify the complete authentication flow works on the live deployment.

Purpose: The user cannot test locally — all verification happens on Vercel. This plan ensures the auth flow works end-to-end in production before the phase is marked complete.
Output: Verified working auth flow on Vercel deployment.
</objective>

<execution_context>
@C:\Users\Gustavo\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Gustavo\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-authentication/02-01-SUMMARY.md
@.planning/phases/02-authentication/02-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Push to GitHub to trigger Vercel deployment</name>
  <files></files>
  <action>
1. Check git status — all Phase 2 code should already be committed from Plans 02-01 and 02-02:
   ```bash
   git status
   git log --oneline -5
   ```
   Verify commits from 02-01 (supabase packages + utilities) and 02-02 (login page + middleware) are present.

2. If there are any uncommitted changes, commit them:
   ```bash
   git add -A
   git commit -m "feat(02-03): final phase 2 cleanup"
   ```

3. Push to origin (GitHub) to trigger Vercel auto-deploy:
   ```bash
   git push origin master
   ```

4. Wait briefly and check that Vercel received the push. The Vercel deployment URL is determined by the project settings. Note the URL for the verification checkpoint.
  </action>
  <verify>
```bash
git log --oneline -5  # Should show Phase 2 commits
git status  # Should be clean
git remote -v  # Should show origin -> github.com/austegui/maissiweb
```
  </verify>
  <done>
All Phase 2 code is pushed to GitHub origin. Vercel auto-deploy is triggered.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Supabase authentication flow: login page, server actions, middleware route protection. The app now requires authentication for all pages and API routes. Unauthenticated users are redirected to /login. Sessions are managed via Supabase cookies.
  </what-built>
  <how-to-verify>
Wait for the Vercel deployment to complete (check Vercel dashboard or GitHub commit status), then:

1. **Test redirect to login:**
   - Open the Vercel deployment URL in a browser (or incognito window)
   - You should be automatically redirected to /login
   - You should see a "Sign in" form with email and password fields

2. **Test login with invalid credentials:**
   - Enter any email and wrong password
   - Click "Sign in"
   - You should see an error message on the login page

3. **Test login with valid credentials:**
   - Enter the email and password you created in the Supabase dashboard (Plan 02-01 Step 5)
   - Click "Sign in"
   - You should be redirected to the inbox (/) and see the WhatsApp conversation list

4. **Test session persistence:**
   - Refresh the page (F5)
   - You should still be on the inbox — NOT redirected back to /login

5. **Test /login redirect when already logged in:**
   - Manually navigate to /login (type it in the address bar)
   - You should be redirected BACK to the inbox (/) since you are already logged in

6. **(Optional) Test logout:**
   - Logout is available via the Server Action but there is no logout button in the UI yet (it will be added in Phase 5 Branding)
   - If you want to test logout, clear your browser cookies for the Vercel domain, then revisit — you should be redirected to /login
  </how-to-verify>
  <resume-signal>Type "approved" if steps 1-5 work correctly, or describe any issues you see</resume-signal>
</task>

</tasks>

<verification>
- Vercel deployment builds successfully (no build errors)
- Unauthenticated visit to / redirects to /login
- Login form renders with email and password fields
- Invalid credentials show error message
- Valid credentials redirect to inbox
- Page refresh maintains session (no re-login needed)
- /login while authenticated redirects to /
</verification>

<success_criteria>
The complete authentication flow is verified on Vercel: login page renders, invalid credentials show errors, valid credentials grant access to inbox, session persists across refresh, and /login redirects to inbox when already authenticated.
</success_criteria>

<output>
After completion, create `.planning/phases/02-authentication/02-03-SUMMARY.md`
</output>
